types
  enum ErrorLibrary {ServiceError, ItemOmission, ServiceOmission, SequenceOmission, TransientServiceOmission, LateServiceStart, EarlyServiceTermination, BoundedOmissionInterval, ItemCommission, ServiceCommission, SequenceCommission, EarlyServiceStart, LateServiceTermination, ItemTimingError, EarlyDelivery, LateDelivery, SequenceTimingError, HighRate, LowRate, RateJitter, ServiceTimingError, DelayedService, EarlyService, TimingError, RateError, EarlyData, LateData, ServiceTimeShift, ItemValueError, UndetectableValueError, DetectableValueError, OutOfRange, BelowRange, AboveRange, OutOfBounds, SequenceValueError, BoundedValueChange, StuckValue, OutOfOrder, ServiceValueError, OutOfCalibration, ValueError, IncorrectValue, ValueCorruption, BadValue, SequenceError, SubtleValueError, BenignValueError, SubtleValueCorruption, ReplicationError, AsymmetricReplicatesError, AsymmetricValue, AsymmetricApproximateValue, AsymmetricExactValue, AsymmetricTiming, AsymmetricOmission, AsymmetricItemOmission, AsymmetricServiceOmission, SymmetricReplicatesError, SymmetricValue, SymmetricApproximateValue, SymmetricExactValue, SymmetricTiming, SymmetricOmission, SymmetricItemOmission, SymmetricServiceOmission, InconsistentValue, InconsistentTiming, InconsistentOmission, InconsistentItemOmission, InconsistentServiceOmission, AsymmetricTransmissive, ConcurrencyError, RaceCondition, ReadWriteRace, WriteWriteRace, MutExError, Deadlock, Starvation}

  enum pump_errors {start_commission, start_omission, stop_commission, stop_omission}

  enum PCA_Error {SecurityError, MessageLeak, MessageLeakMitM, UnlikelyLeak, AuthenticityError, MessageCommission, MessageOmission, MessageReplay, UnlikelyCommission, MessageCorruption, UnlikelyCorruption, start_commission, start_omission, stop_commission, stop_omission, SpO2_ValueError, SpO2_Omission, EarlyServiceTermination, LateServiceTermination, EarlyServiceStart, LateServiceStart}

  alias ErrorLibrary::TimingError = ErrorLibrary::ItemTimingError

  alias ErrorLibrary::BadValue = ErrorLibrary::ItemValueError

  alias ErrorLibrary::InconsistentValue = ErrorLibrary::AsymmetricValue

  alias ErrorLibrary::RateError = ErrorLibrary::SequenceTimingError

  alias ErrorLibrary::InconsistentItemOmission = ErrorLibrary::AsymmetricItemOmission

  alias ErrorLibrary::ValueError = ErrorLibrary::ItemValueError

  alias ErrorLibrary::LateData = ErrorLibrary::LowRate

  alias ErrorLibrary::AsymmetricTransmissive = ErrorLibrary::AsymmetricValue

  alias ErrorLibrary::SequenceError = ErrorLibrary::SequenceValueError

  alias ErrorLibrary::IncorrectValue = ErrorLibrary::ItemValueError

  alias ErrorLibrary::InconsistentOmission = ErrorLibrary::AsymmetricOmission

  alias ErrorLibrary::ServiceTimeShift = ErrorLibrary::ServiceTimingError

  alias ErrorLibrary::SubtleValueCorruption = ErrorLibrary::DetectableValueError

  alias ErrorLibrary::EarlyData = ErrorLibrary::HighRate

  alias ErrorLibrary::InconsistentServiceOmission = ErrorLibrary::AsymmetricServiceOmission

  alias ErrorLibrary::BenignValueError = ErrorLibrary::DetectableValueError

  alias ErrorLibrary::ValueCorruption = ErrorLibrary::ItemValueError

  alias ErrorLibrary::SubtleValueError = ErrorLibrary::UndetectableValueError

  alias ErrorLibrary::InconsistentTiming = ErrorLibrary::AsymmetricTiming

system  PCA_PulseOx_secure_Instance

    sub-components {
      App
        with PCA_Error
          ports
            in SpO2
            out command
          propagations
            SpO2 = {UnlikelyCommission, UnlikelyCorruption, SpO2_ValueError, SpO2_Omission}
            command = {stop_commission, stop_omission, start_commission, start_omission, SecurityError}
          flows
            Check_Status : SpO2 -> command
            inappropriate_ticket_provided : SpO2{SpO2_ValueError, UnlikelyCommission, UnlikelyCorruption} -> command{stop_commission, stop_omission, start_commission, start_omission}
            no_spo2 : SpO2{SpO2_Omission} -> command{stop_omission, start_omission}
            comm_plaintext : * -> command{SecurityError}
            stop_fault : * -> command{stop_omission, stop_commission}

      PCA_Pump
        with PCA_Error
          ports
            out IV_infuse
            in control
          propagations
            control = {stop_commission, stop_omission, start_commission, start_omission, UnlikelyCommission, UnlikelyCorruption}
            IV_infuse = {EarlyServiceTermination, LateServiceTermination, EarlyServiceStart, LateServiceStart}
          flows
            adversary_actions : control{UnlikelyCommission, UnlikelyCorruption} -> IV_infuse{EarlyServiceTermination, LateServiceTermination, EarlyServiceStart, LateServiceStart}
            missed_stop : control{stop_omission} -> IV_infuse{LateServiceTermination}
            incorrect_start : control{start_commission} -> IV_infuse{EarlyServiceStart, LateServiceStart}
            unexpected_stop : control{stop_commission} -> IV_infuse{EarlyServiceTermination, LateServiceTermination}
            missing_start : control{start_omission} -> IV_infuse{LateServiceStart}

      Patient
        with PCA_Error
          ports
            in Vein_infuse
            out BloodSat_Saturation
          propagations
            Vein_infuse = {EarlyServiceTermination, LateServiceTermination, EarlyServiceStart, LateServiceStart}
          flows
            accident : Vein_infuse{EarlyServiceTermination, LateServiceTermination, EarlyServiceStart, LateServiceStart} -> *

      PulseOx
        with ErrorLibrary, pump_errors, PCA_Error
          ports
            in FingerClip_Saturation
            out SpO2
          propagations
            SpO2 = {SpO2_ValueError, SpO2_Omission, SecurityError}
          flows
            numerical_failure : * -> SpO2{SpO2_ValueError}
            disloged_sensor : * -> SpO2{SpO2_Omission}
            communicating_out : * -> SpO2{SecurityError}

      decrypt_command
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {UnlikelyCommission, UnlikelyCorruption, stop_commission, stop_omission, start_commission, start_omission}
            interface_OUT = {UnlikelyCommission, UnlikelyCorruption, stop_commission, stop_omission, start_commission, start_omission}
          flows
            transmission_corruption : interface{UnlikelyCorruption} -> interface{UnlikelyCorruption}
            transmission_start_omission : interface{start_omission} -> interface{start_omission}
            transmission_stop_omission : interface{stop_omission} -> interface{stop_omission}
            transmission_start_commission : interface{start_commission} -> interface{start_commission}
            transmission_stop_commission : interface{stop_commission} -> interface{stop_commission}
            transmission_commission : interface{UnlikelyCommission} -> interface{UnlikelyCommission}

      decrypt_spo2
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {UnlikelyCommission, UnlikelyCorruption, SpO2_ValueError, SpO2_Omission}
            interface_OUT = {UnlikelyCommission, UnlikelyCorruption, SpO2_ValueError, SpO2_Omission}
          flows
            transmission_value : interface{SpO2_ValueError} -> interface{SpO2_ValueError}
            transmission_omission : interface{SpO2_Omission} -> interface{SpO2_Omission}
            transmission_commission : interface{UnlikelyCommission} -> interface{UnlikelyCommission}
            transmission_corruption : interface{UnlikelyCorruption} -> interface{UnlikelyCorruption}

      encrypt_command
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {stop_commission, stop_omission, start_commission, start_omission, SecurityError}
            interface_OUT = {stop_commission, stop_omission, start_commission, start_omission, UnlikelyLeak, MessageLeakMitM}
          flows
            transmission_start_omission : interface{start_omission} -> interface{start_omission}
            transmission_stop_omission : interface{stop_omission} -> interface{stop_omission}
            encrypt_sign : interface{SecurityError} -> interface{UnlikelyLeak, MessageLeakMitM}
            transmission_start_commission : interface{start_commission} -> interface{start_commission}
            transmission_stop_commission : interface{stop_commission} -> interface{stop_commission}

      encrypt_spo2
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {SpO2_ValueError, SpO2_Omission, SecurityError}
            interface_OUT = {SpO2_ValueError, SpO2_Omission, UnlikelyLeak, MessageLeakMitM}
          flows
            encrypt : interface{SecurityError} -> interface{UnlikelyLeak, MessageLeakMitM}
            transmission_value : interface{SpO2_ValueError} -> interface{SpO2_ValueError}
            transmission_omission : interface{SpO2_Omission} -> interface{SpO2_Omission}

      sign_command
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {stop_commission, stop_omission, start_commission, start_omission, UnlikelyLeak, MessageLeakMitM}
            interface_OUT = {stop_commission, stop_omission, start_commission, start_omission, UnlikelyLeak}
          flows
            transmission_start_omission : interface{start_omission} -> interface{start_omission}
            transmission_stop_omission : interface{stop_omission} -> interface{stop_omission}
            transmission_start_commission : interface{start_commission} -> interface{start_commission}
            transmission_unlikely : interface{UnlikelyLeak} -> interface{UnlikelyLeak}
            transmission_stop_commission : interface{stop_commission} -> interface{stop_commission}
            encrypt_sign : interface{MessageLeakMitM} -> *

      sign_spo2
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {SpO2_ValueError, SpO2_Omission, UnlikelyLeak, MessageLeakMitM}
            interface_OUT = {SpO2_ValueError, SpO2_Omission, UnlikelyLeak}
          flows
            encrypt_sign : interface{MessageLeakMitM} -> *
            transmission_unlikely : interface{UnlikelyLeak} -> interface{UnlikelyLeak}
            transmission_value : interface{SpO2_ValueError} -> interface{SpO2_ValueError}
            transmission_omission : interface{SpO2_Omission} -> interface{SpO2_Omission}

      verify_command
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {stop_commission, stop_omission, start_commission, start_omission, MessageCommission, MessageOmission, MessageReplay, MessageCorruption}
            interface_OUT = {UnlikelyCommission, UnlikelyCorruption, stop_commission, stop_omission, start_commission, start_omission}
          flows
            transmission_start_omission : interface{start_omission} -> interface{start_omission}
            transmission_stop_omission : interface{stop_omission} -> interface{stop_omission}
            transmission_start_commission : interface{start_commission} -> interface{start_commission}
            fabrication : interface{MessageCommission} -> interface{UnlikelyCommission, stop_omission, start_omission}
            denial : interface{MessageOmission} -> interface{stop_omission, start_omission}
            transmission_stop_commission : interface{stop_commission} -> interface{stop_commission}
            modifying : interface{MessageCorruption} -> interface{stop_omission, start_omission, UnlikelyCorruption}
            replay_attack : interface{MessageReplay} -> interface{stop_omission, start_omission}

      verify_spo2
        with ErrorLibrary, PCA_Error
          ports
            in interface_IN
            out interface_OUT
          propagations
            interface_IN = {SpO2_ValueError, SpO2_Omission, MessageCommission, MessageOmission, MessageReplay, MessageCorruption}
            interface_OUT = {UnlikelyCommission, UnlikelyCorruption, SpO2_ValueError, SpO2_Omission}
          flows
            denial : interface{MessageOmission} -> interface{SpO2_Omission}
            transmission_omission : interface{SpO2_Omission} -> interface{SpO2_Omission}
            modifying : interface{MessageCorruption} -> interface{SpO2_Omission, UnlikelyCorruption}
            transmission_value : interface{SpO2_ValueError} -> interface{SpO2_ValueError}
            replay_attack : interface{MessageReplay} -> interface{SpO2_Omission}
            fabrication : interface{MessageCommission} -> interface{UnlikelyCommission, SpO2_Omission}

      wifi_secure_command
        with ErrorLibrary, PCA_Error
          ports
            in in_interface
            out out_interface
          propagations
            in_interface = {stop_commission, stop_omission, start_commission, start_omission, UnlikelyLeak}
            out_interface = {stop_commission, stop_omission, start_commission, start_omission, MessageCommission, MessageOmission, MessageReplay, MessageCorruption}
          flows
            transmission_stop_commission : in_interface{stop_commission} -> out_interface{stop_commission}
            accessable : in_interface{UnlikelyLeak} -> *
            transmission_start_commission : in_interface{start_commission} -> out_interface{start_commission}
            spoof_message : * -> out_interface{MessageCommission, MessageOmission, MessageReplay, MessageCorruption}
            transmission_wifi : in_interface -> out_interface
            transmission_start_omission : in_interface{start_omission} -> out_interface{start_omission}
            transmission_stop_omission : in_interface{stop_omission} -> out_interface{stop_omission}

      wifi_secure_spo2
        with ErrorLibrary, PCA_Error
          ports
            in in_interface
            out out_interface
          propagations
            in_interface = {SpO2_ValueError, SpO2_Omission, UnlikelyLeak}
            out_interface = {SpO2_ValueError, SpO2_Omission, MessageCommission, MessageOmission, MessageReplay, MessageCorruption}
          flows
            modify_replay : in_interface{UnlikelyLeak} -> out_interface{MessageReplay, MessageCorruption}
            accessable : in_interface{UnlikelyLeak} -> *
            transmission_value : in_interface{SpO2_ValueError} -> out_interface{SpO2_ValueError}
            fabricate_drop : * -> out_interface{MessageCommission, MessageOmission}
            transmission_omission : in_interface{SpO2_Omission} -> out_interface{SpO2_Omission}
            transmission_wifi : in_interface -> out_interface
    }
    connections
      spo2 : PulseOx.SpO2 -> encrypt_spo2.interface_IN

      protocol_spo2lvl1_s : encrypt_spo2.interface_OUT -> sign_spo2.interface_IN

      protocol_spo2lvl2_s : sign_spo2.interface_OUT -> wifi_secure_spo2.in_interface

      wifi_spo2 : wifi_secure_spo2.out_interface -> verify_spo2.interface_IN

      protocol_spo2lvl2_r : verify_spo2.interface_OUT -> decrypt_spo2.interface_IN

      protocol_spo2lvl1_r : decrypt_spo2.interface_OUT -> App.SpO2

      protocol_commandlvl1_s : encrypt_command.interface_OUT -> sign_command.interface_IN

      protocol_commandlvl2_s : sign_command.interface_OUT -> wifi_secure_command.in_interface

      wifi_command : wifi_secure_command.out_interface -> verify_command.interface_IN

      protocol_commandlvl2_r : verify_command.interface_OUT -> decrypt_command.interface_IN

      protocol_commandlvl1_r : decrypt_command.interface_OUT -> PCA_Pump.control

      administer_secure : PCA_Pump.IV_infuse -> Patient.Vein_infuse

      read : Patient.BloodSat_Saturation -> PulseOx.FingerClip_Saturation

      activate_app : App.command -> encrypt_command.interface_IN